<html><head>

<style>
body {
    background-color: #0d1117 !important;
    color: #c9d1d9 !important;
}
html {
    background-color: #0d1117 !important;
}
h1, h2, h3, h4, h5, h6 {
    color: #58a6ff !important;
}
a {
    color: #58a6ff !important;
}
p, div, span, li, td, th {
    color: #c9d1d9 !important;
}
code {
    background-color: #161b22 !important;
    color: #79c0ff !important;
    padding: 2px 6px !important;
    border-radius: 3px !important;
}
pre {
    background-color: #161b22 !important;
    color: #79c0ff !important;
    padding: 16px !important;
    border-radius: 6px !important;
    border: 1px solid #30363d !important;
}
table {
    border-color: #30363d !important;
}
th {
    background-color: #161b22 !important;
}
</style>



<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>–ü–£–ë–õ–ò–ö–ê–¶–ò–Ø COD-WEB –ß–ï–†–ï–ó HTTPS</title></head><body><article id="3065e03f-0cac-8039-a5c4-e7039b01b9d3" class="page sans"><header><div class="page-header-icon undefined"><span class="icon">üåê</span></div><h1 class="page-title" dir="auto"><strong>–ü–£–ë–õ–ò–ö–ê–¶–ò–Ø COD-WEB –ß–ï–†–ï–ó HTTPS</strong></h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="auto"><h1 id="3065e03f-0cac-80bf-8da7-eacd64c3eb5e" class=""><strong>–ü–£–ë–õ–ò–ö–ê–¶–ò–Ø COD-WEB –ß–ï–†–ï–ó HTTPS</strong></h1></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80c0-b808-d1174c521366" class=""><strong>–ó–ê–î–ê–ß–ê:</strong></p></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-802e-a9b3-f5fbe07ae3aa" class="bulleted-list"><li style="list-style-type:disc">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–∞–π—Ç COD-WEB –ø–æ –≤–Ω–µ—à–Ω–µ–º—É IP COD-RTR</li></ul></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-80e6-b9d9-d701cf9061e9" class="bulleted-list"><li style="list-style-type:disc">–ß–µ—Ä–µ–∑ HTTPS</li></ul></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-8054-8cc2-dceac7740862" class="bulleted-list"><li style="list-style-type:disc">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–æ–±–∞–≤–∏—Ç—å –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –Ω–∞ REMOTE-WORKER</li></ul></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-80a6-b07f-cbf74e2b6c69"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-8033-9ba5-efb110e83bf8" class=""><strong>–®–ê–ì 1: –£–°–¢–ê–ù–û–í–ò–¢–¨ –í–ï–ë-–°–ï–†–í–ï–† –ù–ê COD-WEB</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-804b-b387-cb9c93786038" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ COD-WEB
apt update
apt install -y nginx

# –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–∞–π—Ç
mkdir -p /var/www/html
echo &quot;&lt;h1&gt;Welcome to COD-WEB&lt;/h1&gt;&quot; &gt; /var/www/html/index.html

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
systemctl enable nginx
systemctl start nginx</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8016-944e-d29ca93157cd" class=""><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8093-81d2-dbc6dc92895e" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">curl http://10.10.20.100</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-8013-acfb-ebcdebc4b774"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-80c1-88f5-e6a30dd7fa22" class=""><strong>–®–ê–ì 2: –°–û–ó–î–ê–¢–¨ SSL –°–ï–†–¢–ò–§–ò–ö–ê–¢ –ù–ê MAIN-DC1 (CA)</strong></h2></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8054-9c63-d5b742b1e068" class=""><strong>–ó–∞—á–µ–º:</strong> FreeIPA ‚Äî —Ü–µ–Ω—Ç—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û–Ω –≤—ã–¥–∞—Å—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è COD-WEB.</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-806a-81a5-c98fffb98780" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ MAIN-DC1
kinit admin

# –°–æ–∑–¥–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è COD-WEB
ipa-getcert request \
  -K HTTP/cod-web.reaskills.cyber \
  -k /etc/pki/tls/private/cod-web.key \
  -f /etc/pki/tls/certs/cod-web.crt \
  -D cod-web.reaskills.cyber</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80b2-92d9-c7dce473ad98" class=""><strong>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80bc-b3ad-d6005c87b435" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">ipa-getcert list</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-804f-a21f-cc6fd0aac46d" class=""><strong>–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:</strong> <code>status: MONITORING</code></p></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-802d-bc59-e07224c3a9a6" class=""><strong>–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –Ω–∞ COD-WEB:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-809b-8a9d-c824d7f3e801" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ MAIN-DC1
scp /etc/pki/tls/certs/cod-web.crt root@COD-WEB:/etc/nginx/
scp /etc/pki/tls/private/cod-web.key root@COD-WEB:/etc/nginx/
scp /etc/ipa/ca.crt root@COD-WEB:/etc/nginx/ca.crt</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-80b9-b577-de642be6004f"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-8078-8506-e59025bf521e" class=""><strong>–®–ê–ì 3: –ù–ê–°–¢–†–û–ò–¢–¨ NGINX –ù–ê COD-WEB –î–õ–Ø HTTPS</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80d0-8dba-f24e1891249a" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ COD-WEB
nano /etc/nginx/sites-available/default</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8026-8be6-ef124403cb70" class=""><strong>–ó–∞–º–µ–Ω–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80ae-8cc6-e57f5474a913" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">server {
    listen 443 ssl;
    server_name cod-web.reaskills.cyber;

    ssl_certificate /etc/nginx/cod-web.crt;
    ssl_certificate_key /etc/nginx/cod-web.key;

    root /var/www/html;
    index index.html;

    location / {
        try_files $uri $uri/ =404;
    }
}

server {
    listen 80;
    return 301 https://$host$request_uri;
}</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-802b-bfaa-f64c172afc59" class=""><strong>–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80b3-bf66-c512fd829e2e" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">systemctl restart nginx</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-801c-86c6-c4c2e68f8443"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-80d6-a060-c5f11a1e0054" class=""><strong>–®–ê–ì 4: –ù–ê–°–¢–†–û–ò–¢–¨ –ü–†–û–ë–†–û–° –ü–û–†–¢–û–í –ù–ê COD-RTR</strong></h2></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80d5-8d7f-ed188b1cff71" class=""><strong>–ù–∞ COD-RTR –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å DNAT (–ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8021-bcb8-df940332a291" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ü—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç 443 (HTTPS) –Ω–∞ COD-WEB
nft add rule ip nat prerouting iifname &quot;eth0&quot; tcp dport 443 dnat to 10.10.20.100:443

# –ü—Ä–æ–±—Ä–æ—Å–∏—Ç—å –ø–æ—Ä—Ç 80 (HTTP) –Ω–∞ COD-WEB
nft add rule ip nat prerouting iifname &quot;eth0&quot; tcp dport 80 dnat to 10.10.20.100:80

# –†–∞–∑—Ä–µ—à–∏—Ç—å forward
nft add rule inet filter forward ct state new tcp dport { 80, 443 } accept</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8008-b3e6-ed23d2767ba9" class=""><strong>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8049-b34f-d4ce6917e9b1" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">nft list ruleset &gt; /etc/nftables.conf</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-806b-8160-c04a6f281173"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-8026-9678-e6d67e7facfc" class=""><strong>–®–ê–ì 5: –î–û–ë–ê–í–ò–¢–¨ –°–ï–†–¢–ò–§–ò–ö–ê–¢ –í –î–û–í–ï–†–ï–ù–ù–´–ï –ù–ê REMOTE-WORKER</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80ce-9505-c5b01207daae" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ REMOTE-WORKER —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å CA —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å MAIN-DC1
scp root@MAIN-DC1:/etc/ipa/ca.crt /tmp/

# –î–æ–±–∞–≤–∏—Ç—å –≤ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ
cp /tmp/ca.crt /usr/local/share/ca-certificates/ipa-ca.crt
update-ca-certificates</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80e4-8ddc-fc290b0d68d9" class=""><strong>–ü—Ä–æ–≤–µ—Ä–∫–∞:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-807f-adad-ea61f3a125c8" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">curl https://&lt;IP_COD-RTR&gt;</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8075-abda-dc320623cb7d" class=""><strong>–î–æ–ª–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å—Å—è –ë–ï–ó –æ—à–∏–±–æ–∫ SSL.</strong></p></div><div style="display:contents" dir="auto"><h1 id="3065e03f-0cac-8068-8f7c-e31608487009" class=""><strong>–í–ï–ë-–°–ï–†–í–ï–† </strong><strong><a href="http://www.reaskills.cyber/">www.reaskills.cyber</a></strong><strong> –ù–ê MAIN-STORAGE2</strong></h1></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80f1-aff1-d5a80a2bd7f1" class=""><strong>–ó–ê–î–ê–ß–ê:</strong></p></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-8053-ba42-c74905a89b1a" class="bulleted-list"><li style="list-style-type:disc">–§–∞–π–ª–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–∞ <code>/data_saver</code></li></ul></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-80a1-b951-f950f91c08d2" class="bulleted-list"><li style="list-style-type:disc">–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ TopManager –∏–∑ FreeIPA</li></ul></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-80ca-b25a-f701925cdbef" class="bulleted-list"><li style="list-style-type:disc">HTTPS</li></ul></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-8011-9b69-db80fe07fe53" class="bulleted-list"><li style="list-style-type:disc">–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤</li></ul></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-80bf-b8a2-ecc8fe7abaa4"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-80e7-958a-ed80281ace33" class=""><strong>–®–ê–ì 1: –£–°–¢–ê–ù–û–í–ò–¢–¨ –í–ï–ë-–°–ï–†–í–ï–†</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8011-a5ef-f2287b9a7dd9" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ MAIN-STORAGE2
apt update
apt install -y nginx apache2-utils</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-8043-b845-e410f5e8a0b4"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-804e-9017-e6ba2559d547" class=""><strong>–®–ê–ì 2: –°–û–ó–î–ê–¢–¨ –î–ò–†–ï–ö–¢–û–†–ò–Æ –ò –§–ê–ô–õ–´</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8053-9897-f09c4fb7ea33" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">mkdir -p /data_saver
echo &quot;&lt;h1&gt;Secure File Server&lt;/h1&gt;&quot; &gt; /data_saver/index.html
echo &quot;Test file 1&quot; &gt; /data_saver/file1.txt
echo &quot;Test file 2&quot; &gt; /data_saver/file2.txt
chmod -R 755 /data_saver</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-801b-9747-c92e05122dca"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-808a-bfc3-eb9047a5ccdc" class=""><strong>–®–ê–ì 3: –ù–ê–°–¢–†–û–ò–¢–¨ –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Æ –ß–ï–†–ï–ó FreeIPA</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80ba-96c6-e4bbc98c32c9" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–æ–¥—É–ª—å –¥–ª—è LDAP –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
apt install -y libnginx-mod-http-auth-pam libpam-ldap

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å PAM –¥–ª—è LDAP
nano /etc/pam.d/nginx</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-800b-9d03-e01af48778e5" class=""><strong>–í—Å—Ç–∞–≤—å:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8057-96ad-ddb5adc4f353" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">auth required pam_ldap.so
account required pam_ldap.so</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80a7-a9de-c4c2bfed1d06" class=""><strong>–ù–∞—Å—Ç—Ä–æ–∏—Ç—å LDAP:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80bd-aa03-f12835ebce77" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">nano /etc/ldap/ldap.conf</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-80f2-9bd1-e7d8dbd1f7c2" class=""><strong>–î–æ–±–∞–≤—å:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8000-a7c2-c8bcfe0f9ffb" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">BASE dc=reaskills,dc=cyber
URI ldap://192.168.1.10
TLS_CACERT /etc/ipa/ca.crt</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-8061-a690-ea38d5307f1b"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-8043-bf6d-df9af3051c53" class=""><strong>–®–ê–ì 4: –ü–û–õ–£–ß–ò–¢–¨ SSL –°–ï–†–¢–ò–§–ò–ö–ê–¢</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-801f-93b6-c8d4deda35e3" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ MAIN-DC1
ipa-getcert request \
  -K HTTP/www.reaskills.cyber \
  -k /etc/pki/tls/private/www.key \
  -f /etc/pki/tls/certs/www.crt \
  -D www.reaskills.cyber

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ MAIN-STORAGE2
scp /etc/pki/tls/certs/www.crt root@MAIN-STORAGE2:/etc/nginx/
scp /etc/pki/tls/private/www.key root@MAIN-STORAGE2:/etc/nginx/</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-807b-b49c-f0b465964d48"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-802b-9500-cc4e23d0641f" class=""><strong>–®–ê–ì 5: –ù–ê–°–¢–†–û–ò–¢–¨ NGINX</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8049-bb68-d9ddd8121932" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">nano /etc/nginx/sites-available/fileserver</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-809d-977f-c8254f20a6cc" class=""><strong>–í—Å—Ç–∞–≤—å:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-80c6-824f-f0863dfd800b" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">server {
    listen 443 ssl;
    server_name www.reaskills.cyber;

    ssl_certificate /etc/nginx/www.crt;
    ssl_certificate_key /etc/nginx/www.key;

    root /data_saver;
    autoindex on;
    autoindex_exact_size off;
    autoindex_localtime on;

    auth_pam &quot;Secure Area&quot;;
    auth_pam_service_name &quot;nginx&quot;;

    location / {
        try_files $uri $uri/ =404;
    }
}</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8069-a297-d9e80460c1d2" class=""><strong>–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-806a-8075-f173a2502485" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">ln -s /etc/nginx/sites-available/fileserver /etc/nginx/sites-enabled/
systemctl restart nginx</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-80b4-8ba1-f7a128f0797b"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-805f-b697-eaa770662ab7" class=""><strong>–®–ê–ì 6: –î–û–ë–ê–í–ò–¢–¨ DNS –ó–ê–ü–ò–°–¨</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8018-b2c9-d119f07c18f8" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ MAIN-DC1
kinit admin
ipa dnsrecord-add reaskills.cyber www --a-rec=192.168.2.20</code></pre></div><div style="display:contents" dir="auto"><hr id="3065e03f-0cac-80e5-94f4-d11c44d3dcf8"/></div><div style="display:contents" dir="auto"><h2 id="3065e03f-0cac-8018-b433-d205544c4e69" class=""><strong>–®–ê–ì 7: –ü–†–û–í–ï–†–ö–ê –° PC1</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3065e03f-0cac-8005-b908-d33621ee5377" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># –ù–∞ PC1
firefox https://www.reaskills.cyber</code></pre></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-806e-b704-e1e3fc6aae77" class=""><strong>–î–æ–ª–∂–µ–Ω –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å:</strong></p></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-804f-aba1-dd86c9af2e4a" class="bulleted-list"><li style="list-style-type:disc">–õ–æ–≥–∏–Ω: <code>superuser100</code></li></ul></div><div style="display:contents" dir="auto"><ul id="3065e03f-0cac-8009-93de-fbe4b14e72a7" class="bulleted-list"><li style="list-style-type:disc">–ü–∞—Ä–æ–ª—å: <code>P@ssw0rdTop</code></li></ul></div><div style="display:contents" dir="auto"><p id="3065e03f-0cac-8023-b4f0-da9746653feb" class=""><strong>–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤.</strong></p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>